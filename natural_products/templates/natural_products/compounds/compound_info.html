<!doctype html>
<html lang="en">

  {% include 'header.html' %}
  {% load static %}
  <script type="text/javascript" src="{%static 'natural_products/categories.js' %}"></script>

  <body class="right" onload="makeDataTable(
      ['PROPERTIESTable', 'ALL_TARGETSTable', 
        'ANTITARGETSTable', 'EFFECTSTable', 'GENE_EXPRESSIONTable', 
        'MECHANISMSTable', 'METABOLISMTable', 'TOXICITYTable', 'TRANSPORTERSTable',
        'PATHWAYSTable', 'REACTIONSTable'], 
      [0, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3])">

    {% include 'navbar.html' %}
    
    <header>
      <h1>{{compound_name}}</h1>
      <p>Activities for Pa threshold: {{threshold}}</p>
    </header>

    <nav id="categorySidebar" class="sidenav sidenav-right">
      <div style="text-align: center;">
        <h2>Activities</h2>
      </div>
      <a href="#PROPERTIES" onclick="showDiv(this)">PROPERTIES</a>
      {% if activities %}
      {% for category, category_activities in activities.items %}
      <a href="#{{category}}" onclick="showDiv(this)">{{category}}</a>
      {% endfor %}
      {% endif %}
      {% if pathways %}
      <a href="#PATHWAYS" onclick="showDiv(this)">PATHWAYS</a>
      {% endif %}
      {% if reactions %}
      <a href="#REACTIONS" onclick="showDiv(this)">REACTIONS</a>
      {% endif %}
    </nav>

    <main>

      {% if img_filename %}
      <div>
      <h2>2D Image</h2>
        <img src="{% static img_filename %}" 
          style="width: 20%; height: 20%;" >
      </div>
      {% endif %}

      <br>

      <div class="hiddenDiv" style="display: none;">

        <div id="nav-#PROPERTIES" style="display: inline;">
          
          <h2>Molecule Properties</h2>
          <table id="PROPERTIESTable" class="display-table" >
            <thead>
            <tr>
              <th>Property Name</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            {% for key, value in compound_info.items %}
            <tr>
              <td>{{key}}</td>
              <td>{{value}}</td>
            </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>

        {% if activities %}
        
        {% for category, category_activities in activities.items %}

        <div id="nav-#{{category}}" style="display: none;">
              
          <h2>{{category}}</h2>
          <table id="{{category}}Table" class="display table data" 
              style="width:100%;text-align:center;display:inline;">
                    
            <thead>
              <tr>
                <th>Target</th>
                <!-- <th>Pa</th> -->
                <!-- <th>Pi</th> -->
                <th>Confidence Score</th>
              </tr>
            </thead>
                    
            <tbody>
              {% for target, target_encoded, pa, pi, diff in category_activities %}
              <tr>
                <td><a href="/natural_products/targets/all/{{target_encoded}}">{{target}}</a></td>
                <!-- <td>{{pa}}</td> -->
                <!-- <td>{{pi}}</td> -->
                <td>{{diff}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% endfor %}
        {% endif %}

        <!-- pathways -->
        <div id="nav-#PATHWAYS"  style="display: none;">
        
          <h2>Pathways</h2>
          <table id="PATHWAYSTable" class="display table data"
              style="width:100%;text-align:center;display:inline;">
              
            <thead>
              <tr>
                <th>Uniprot ACCs</th>
                <th>Number Uniprot ACCs</th>
                <th>Total ACCs</th>
                <th>Uniprot Coverage</th>
                <th>Pathway Name</th>
                <th>Pathway Organism</th>
                <th>Reactome URL</th>
              </tr>
            </thead>
              
            <tbody>
              {% for accs, num_accs, total_accs, coverage, pathway_name, pathway_name_encoded, organism, organism_encoded, url in pathways %}
              <tr>
                <td>{{accs}}</td>
                <td>{{num_accs}}</td>
                <td>{{total_accs}}</td>
                <td>{{coverage}}</td>
                <td><a href="/natural_products/pathways/all/{{pathway_name_encoded}}:_:{{organism_encoded}}">{{pathway_name}}</a></td>
                <td>{{organism}}</td>
                <td><a href="{{url}}">{{pathway_name}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- reactions -->

        <div id="nav-#REACTIONS" style="display: none;">
      
          <h2>Reactions</h2>
          <table id="REACTIONSTable" class="display table data"
            style="width:100%;text-align:center;display:inline;">
            
            <thead>
              <tr>
                <th>Uniprot ACCs</th>
                <th>Number Uniprot ACCs</th>
                <th>Total ACCs</th>
                <th>Uniprot Coverage</th>
                <th>Reaction Name</th>
                <th>Reaction Organism</th>
                <th>Reactome URL</th>
              </tr>
            </thead>
            
            <tbody>
              {% for accs, num_accs, total_accs, coverage, reaction_name, reaction_name_encoded, organism, organism_encoded, url in reactions %}
              <tr>
                <td>{{accs}}</td>
                <td>{{num_accs}}</td>
                <td>{{total_accs}}</td>
                <td>{{coverage}}</td>
                <td><a href="/natural_products/reactions/all/{{reaction_name_encoded}}:_:{{organism_encoded}}">{{reaction_name}}</a></td>
                <td>{{organism}}</td>
                <td><a href="{{url}}">{{reaction_name}}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

    </main>

    <footer>
      <form action="/">
        <input type="submit" 
          value="Return to home">
      </form>
    </footer>

  </body>
</html>
